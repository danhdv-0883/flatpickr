{"version":3,"file":"weekSelect.js","sources":["../../../src/plugins/weekSelect/weekSelect.ts"],"sourcesContent":["import { DayElement } from \"../../types/instance\";\nimport { Plugin } from \"../../types/options\";\n\nexport type PlusWeeks = {\n  weekStartDay: Date;\n  weekEndDay: Date;\n};\n\nfunction weekSelectPlugin(): Plugin<PlusWeeks> {\n  return function(fp) {\n    function onDayHover(event: MouseEvent) {\n      const day = event.target as DayElement;\n      if (!day.classList.contains(\"flatpickr-day\")) return;\n\n      const days = fp.days.childNodes;\n      const dayIndex = day.$i;\n\n      const dayIndSeven = dayIndex / 7;\n      const weekStartDay = (days[7 * Math.floor(dayIndSeven)] as DayElement)\n        .dateObj;\n      const weekEndDay = (days[\n        7 * Math.ceil(dayIndSeven + 0.01) - 1\n      ] as DayElement).dateObj;\n\n      for (let i = days.length; i--; ) {\n        const day = days[i] as DayElement;\n        const date = day.dateObj;\n        if (date > weekEndDay || date < weekStartDay)\n          day.classList.remove(\"inRange\");\n        else day.classList.add(\"inRange\");\n      }\n    }\n\n    function highlightWeek() {\n      const selDate = fp.latestSelectedDateObj;\n      if (\n        selDate !== undefined &&\n        selDate.getMonth() === fp.currentMonth &&\n        selDate.getFullYear() === fp.currentYear\n      ) {\n        fp.weekStartDay = (fp.days.childNodes[\n          7 * Math.floor((fp.selectedDateElem as DayElement).$i / 7)\n        ] as DayElement).dateObj;\n        fp.weekEndDay = (fp.days.childNodes[\n          7 * Math.ceil((fp.selectedDateElem as DayElement).$i / 7 + 0.01) - 1\n        ] as DayElement).dateObj;\n      }\n      const days = fp.days.childNodes;\n      for (let i = days.length; i--; ) {\n        const date = (days[i] as DayElement).dateObj;\n        if (date >= fp.weekStartDay && date <= fp.weekEndDay)\n          (days[i] as DayElement).classList.add(\"week\", \"selected\");\n      }\n    }\n\n    function clearHover() {\n      const days = fp.days.childNodes;\n      for (let i = days.length; i--; )\n        (days[i] as Element).classList.remove(\"inRange\");\n    }\n\n    function onReady() {\n      if (fp.daysContainer !== undefined)\n        fp.daysContainer.addEventListener(\"mouseover\", onDayHover);\n    }\n\n    function onDestroy() {\n      if (fp.daysContainer !== undefined)\n        fp.daysContainer.removeEventListener(\"mouseover\", onDayHover);\n    }\n\n    return {\n      onValueUpdate: highlightWeek,\n      onMonthChange: highlightWeek,\n      onYearChange: highlightWeek,\n      onOpen: highlightWeek,\n      onClose: clearHover,\n      onParseConfig: function() {\n        fp.config.mode = \"single\";\n        fp.config.enableTime = false;\n        fp.config.dateFormat = fp.config.dateFormat\n          ? fp.config.dateFormat\n          : \"\\\\W\\\\e\\\\e\\\\k #W, Y\";\n        fp.config.altFormat = fp.config.altFormat\n          ? fp.config.altFormat\n          : \"\\\\W\\\\e\\\\e\\\\k #W, Y\";\n      },\n      onReady: [\n        onReady,\n        highlightWeek,\n        () => {\n          fp.loadedPlugins.push(\"weekSelect\");\n        },\n      ],\n      onDestroy,\n    };\n  };\n}\n\nexport default weekSelectPlugin;\n"],"names":[],"mappings":"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"}